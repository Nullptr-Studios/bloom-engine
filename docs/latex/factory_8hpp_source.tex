\doxysection{factory.\+hpp}
\hypertarget{factory_8hpp_source}{}\label{factory_8hpp_source}\index{C:/Users/xgoni/bloom/bloom/src/factory.hpp@{C:/Users/xgoni/bloom/bloom/src/factory.hpp}}
\mbox{\hyperlink{factory_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{actor_8hpp}{objects/actor.hpp}}"{}}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{object_8hpp}{objects/object.hpp}}"{}}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacebloom}{bloom}}\ \{}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00022\ \textcolor{keyword}{class\ }BLOOM\_API\ \mbox{\hyperlink{classbloom_1_1_factory}{Factory}}\ \{}
\DoxyCodeLine{00023\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00024\ \ \ \mbox{\hyperlink{classbloom_1_1_factory}{Factory}}()\ \{\ m\_instance\ =\ \textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00025\ \ \ \mbox{\hyperlink{classbloom_1_1_factory}{\string~Factory}}()\ \{\ m\_instance\ =\ \textcolor{keyword}{nullptr};\ \}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \ \ \textcolor{comment}{//\ Copy\ constructor}}
\DoxyCodeLine{00028\ \ \ \mbox{\hyperlink{classbloom_1_1_factory}{Factory}}\ \&operator=(\textcolor{keyword}{const}\ \mbox{\hyperlink{classbloom_1_1_factory}{Factory}}\ \&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00029\ \ \ \mbox{\hyperlink{classbloom_1_1_factory}{Factory}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classbloom_1_1_factory}{Factory}}\ \&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00037\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T,\ \textcolor{keyword}{typename}\ =\ std::enable\_if\_t<std::is\_base\_of\_v<Object,\ T>>>}
\DoxyCodeLine{00038\ \ \ std::shared\_ptr<T>\ CreateObject(\textcolor{keyword}{const}\ std::string\&\ name\ =\ \textcolor{stringliteral}{"{}Unnamed\ Object"{}});}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00044\ \ \ \mbox{\hyperlink{namespacebloom_ac65b651055bbc2100bc99fb9bd34ac17}{ObjectMap}}\ \mbox{\hyperlink{classbloom_1_1_factory_a71867caa8196a0bb2c5585c87e503eb4}{GetObjects}}()\ \{\ \textcolor{keywordflow}{return}\ m\_objects;\ \}}
\DoxyCodeLine{00049\ \ \ \mbox{\hyperlink{namespacebloom_a0a6a92f666ce85e7aaa009b4a2af96ee}{ActorMap}}\ \mbox{\hyperlink{classbloom_1_1_factory_a95d6a115fd1defdaae6501cad2a692e5}{GetRenderables}}()\ \{\ \textcolor{keywordflow}{return}\ m\_renderables;\ \}}
\DoxyCodeLine{00054\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classbloom_1_1_factory}{Factory}}*\ \mbox{\hyperlink{classbloom_1_1_factory_abd79523c7412ce560106616ccdc6ab1a}{GetInstance}}()\ \{}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keywordflow}{if}\ (!m\_instance)\ \{}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \mbox{\hyperlink{log_8hpp_a23eb17bcc83048e0735c5e77e2638a33}{BLOOM\_ERROR}}(\textcolor{stringliteral}{"{}Tried\ to\ access\ Factory\ but\ it\ has\ not\ been\ created\ yet"{}});}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00058\ \ \ \ \ \}}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keywordflow}{return}\ m\_instance;}
\DoxyCodeLine{00060\ \ \ \}}
\DoxyCodeLine{00065\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classbloom_1_1_factory_aaef96a35c8a521bdfd63fdc223190882}{DestroyAllObjects}}()\ \{}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \&[\textcolor{keywordtype}{id},\ \textcolor{keywordtype}{object}]\ :\ m\_objects)\ \{}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \textcolor{keywordtype}{object}-\/>OnClose();}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \textcolor{keywordtype}{object}.reset();}
\DoxyCodeLine{00069\ \ \ \ \ \}}
\DoxyCodeLine{00070\ \ \ \ \ m\_objects.clear();}
\DoxyCodeLine{00071\ \ \ \ \ m\_renderables.clear();}
\DoxyCodeLine{00072\ \ \ \}}
\DoxyCodeLine{00073\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00074\ \ \ \mbox{\hyperlink{core_8hpp_abaf665e52c9979a5f6eb9ecfce756efc}{id\_t}}\ m\_currentID\ =\ 0;\ \ \ }
\DoxyCodeLine{00075\ \ \ \mbox{\hyperlink{namespacebloom_ac65b651055bbc2100bc99fb9bd34ac17}{ObjectMap}}\ m\_objects;\ \ \ \ }
\DoxyCodeLine{00076\ \ \ \mbox{\hyperlink{namespacebloom_a0a6a92f666ce85e7aaa009b4a2af96ee}{ActorMap}}\ m\_renderables;\ }
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classbloom_1_1_factory}{Factory}}*\ m\_instance;}
\DoxyCodeLine{00079\ \};}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T,\ \textcolor{keyword}{typename}>}
\DoxyCodeLine{00082\ std::shared\_ptr<T>\ \mbox{\hyperlink{classbloom_1_1_factory_af514408c2042144df3700f690554bc6e}{Factory::CreateObject}}(\textcolor{keyword}{const}\ std::string\&\ name)\ \{}
\DoxyCodeLine{00083\ \ \ std::shared\_ptr<T>\ obj\ =\ std::make\_shared<T>(m\_currentID);}
\DoxyCodeLine{00084\ \ \ obj-\/>SetName(name);}
\DoxyCodeLine{00085\ \ \ m\_currentID++;}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \textcolor{comment}{//\ This\ crashes\ the\ program,\ it\ will\ work\ for\ now\ -\/x}}
\DoxyCodeLine{00088\ \ \ \textcolor{keywordflow}{if}\ (m\_currentID\ ==\ 0)\ \{}
\DoxyCodeLine{00089\ \ \ \ \ \mbox{\hyperlink{log_8hpp_af6ca84c4d0058fec875875ed0cdf9f41}{BLOOM\_CRITICAL}}(\textcolor{stringliteral}{"{}Reached\ maximum\ number\ of\ objects"{}});}
\DoxyCodeLine{00090\ \ \ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ m\_objects.emplace(obj-\/>GetID(),\ std::static\_pointer\_cast<Object>(obj));}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \textcolor{comment}{//\ Adding\ to\ the\ renderable\ list\ if\ it's\ an\ Actor}}
\DoxyCodeLine{00095\ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_base\_of\_v<Actor,\ T>)\ \{}
\DoxyCodeLine{00096\ \ \ \ \ m\_renderables.emplace(obj-\/>GetID(),\ std::static\_pointer\_cast<Actor>(obj));}
\DoxyCodeLine{00097\ \ \ \}}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \mbox{\hyperlink{log_8hpp_ac5b86dacb08981467781745537e91c30}{BLOOM\_INFO}}(\textcolor{stringliteral}{"{}Created\ object\ \{0\}\ with\ ID:\ \{1\}"{}},\ name,\ obj-\/>GetID());}
\DoxyCodeLine{00100\ \ \ \textcolor{keywordflow}{return}\ obj;}
\DoxyCodeLine{00101\ \}}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \}}

\end{DoxyCode}
